# Quick Start

## Initial Setup

Install required dependencies:
```bash
make install
```

This installs `pybind11` via pip. You also need a C++ compiler:
- **Windows**: MSVC (install via Visual Studio Build Tools)
- **Linux/Mac**: g++ or clang++ (usually pre-installed)

## Build and Run

The Makefile works on both Linux and Windows:

```bash
make          # Build the leducsolver module, copy to src/pysrc/
make test     # Build and run the Leduc CFR solver
make best     # Build and compute Best Response exploitability
make clean    # Remove build artifacts and output files
```

After building, run Python scripts directly:
```bash
cd src/pysrc
python Leduc.py         # Train CFR solver (100k iterations)
python BestResponse.py  # Compute exploitability of trained strategy
```

**Note**: On Linux/Mac, use `python3` instead of `python`.

## Project Structure

```
TiltStack/
├── Makefile                # Build commands
├── setup.py                # C++ compilation config
├── build/                  # Build artifacts (auto-created)
├── leduc_results.txt       # CFR strategy output (generated by make test)
├── leduc_strategy.csv      # CFR strategy CSV (generated by make test)
├── br_results.txt          # Best Response output (generated by make best)
└── src/
    ├── cppsrc/             # C++ source
    │   ├── Node.h           # Game tree types and declarations
    │   ├── Node.cpp         # Node/NodeInfo implementation
    │   ├── Leduc.h          # LeducSolver declaration
    │   ├── Leduc.cpp        # CFR solver implementation
    │   ├── BestResponse.h   # BestResponse declaration
    │   ├── BestResponse.cpp # Best Response solver implementation
    │   └── bindings.cpp     # PyBind11 wrappers (leducsolver module)
    └── pysrc/               # Python source
        ├── leducsolver.pyd     # Compiled module (copied here after build)
        ├── Leduc.py            # CFR training loop and output
        └── BestResponse.py     # Best Response computation
```

## Workflow

### Training CFR Strategy
1. Edit C++ solver code in `src/cppsrc/` if needed
2. Run `make` to build
3. Run `make test` or `python src/pysrc/Leduc.py` to train
4. Check `leduc_results.txt` for human-readable strategy
5. Check `leduc_strategy.csv` for machine-readable strategy

### Measuring Exploitability
1. After training CFR, run `make best` or `python src/pysrc/BestResponse.py`
2. Check `br_results.txt` for:
   - Player 0 Best Response strategy and EV
   - Player 1 Best Response strategy and EV
   - Overall exploitability metric

### Output Format
All strategy files use player markers `(0)` or `(1)` before each node to indicate which player is to move:
```
(0) J:           -> c:0.91, r:0.09
(1) J:r          -> c:0.79, b:0.16, r:0.05
```

## Adding C++ Bindings

**src/cppsrc/bindings.cpp:**
```cpp
#include <pybind11/pybind11.h>
#include "Leduc.cpp"
#include "Node.cpp"

namespace py = pybind11;

PYBIND11_MODULE(leducsolver, m) {
    py::class_<LeducSolver>(m, "LeducSolver")
        .def(py::init<>())
        .def("cfr", &LeducSolver::cfr);
}
```

**Python usage:**
```python
from leducsolver import LeducSolver, Rank
solver = LeducSolver()
solver.cfr([Rank.JACK, Rank.QUEEN, Rank.KING], 0, [1.0, 1.0])
```
